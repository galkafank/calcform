<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Опросный лист Macroscop</title>
    <style>
        :root {
            --primary: #ff7700;
            --primary-light: #ffa500;
            --secondary: #fff9f2;
            --border: #ffd8b1;
            --text: #333;
            --white: #ffffff;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 12px;
        }
        
        body {
            background: linear-gradient(135deg, #fff9f2, #ffe5cc);
            color: var(--text);
            padding: 10px;
            line-height: 1.3;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        /* Tabs styling */
        .tabs {
            display: flex;
            background: linear-gradient(to right, var(--primary), var(--primary-light));
        }
        
        .tab {
            padding: 8px 12px;
            cursor: pointer;
            color: var(--white);
            font-weight: 600;
            position: relative;
            transition: background 0.15s;
            border-right: 1px solid rgba(255,255,255,0.2);
        }
        
        .tab:last-child {
            border-right: none;
        }
        
        .tab.active {
            background: var(--white);
            color: var(--primary);
        }
        
        /* Tab content */
        .tab-content {
            display: none;
            padding: 10px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        h2 {
            color: var(--primary);
            margin: 8px 0 6px;
            padding-bottom: 3px;
            border-bottom: 1px solid var(--border);
            font-size: 14px;
            position: relative;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 80px;
            height: 1px;
            background: var(--primary);
        }
        
        h3 {
            color: var(--primary-light);
            margin: 8px 0 6px;
            font-size: 13px;
        }
        
        .question {
            margin-bottom: 8px;
            padding: 6px;
            background: var(--secondary);
            border-radius: 3px;
            border-left: 2px solid var(--primary);
        }
        
        .question-label {
            font-weight: 600;
            margin-bottom: 4px;
            display: block;
            font-size: 12px;
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 4px;
            color: var(--primary);
            font-weight: bold;
            cursor: help;
            font-size: 10px;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 180px;
            background: #333;
            color: white;
            text-align: center;
            border-radius: 3px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.15s;
            font-weight: normal;
            font-size: 11px;
            line-height: 1.2;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Form elements */
        input[type="number"], select, textarea {
            width: 100%;
            padding: 4px 6px;
            border: 1px solid var(--border);
            border-radius: 2px;
            background: var(--white);
            margin-top: 3px;
            font-size: 12px;
        }
        
        .resolution-group {
            display: flex;
            gap: 8px;
            margin-top: 5px;
        }
        
        .resolution-group > div {
            flex: 1;
        }
        
        .analytics-section {
            margin-top: 5px;
            padding: 5px;
            background: var(--white);
            border-radius: 2px;
            border: 1px dashed var(--border);
        }
        
        .analytics-item {
            display: flex;
            align-items: center;
            margin-bottom: 4px;
        }
        
        .analytics-item select {
            flex: 1;
            margin-right: 4px;
            padding: 3px 5px;
        }
        
        .btn-small {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 2px;
            padding: 3px 6px;
            cursor: pointer;
            font-size: 11px;
            margin: 2px 0;
        }
        
        .btn-small.remove {
            background: #ff4444;
        }
        
        .checkbox-group, .radio-group {
            display: flex;
            gap: 10px;
            margin-top: 4px;
            flex-wrap: wrap;
        }
        
        .checkbox-item, .radio-item {
            display: flex;
            align-items: center;
            font-size: 12px;
        }
        
        .checkbox-item input, .radio-item input {
            margin-right: 3px;
        }
        
        .hidden {
            display: none;
        }
        
        .camera-set {
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 8px;
            margin-top: 8px;
            position: relative;
            background: var(--white);
        }
        
        .remove-set {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            cursor: pointer;
            font-weight: bold;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }
        
        .add-set {
            margin: 8px 0;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 2px;
            padding: 4px 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 12px;
        }
        
        .infrastructure-options {
            margin-top: 5px;
        }
        
        .infrastructure-option {
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }
        
        .infrastructure-option input[type="radio"] {
            margin-right: 4px;
        }
        
        .custom-answer {
            margin-top: 5px;
            display: none;
        }
        
        .custom-answer.active {
            display: block;
        }
        
        /* Buttons */
        .form-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding: 10px;
            background: var(--secondary);
            border-top: 1px solid var(--border);
            gap: 8px;
        }
        
        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-weight: 600;
            font-size: 12px;
            transition: all 0.15s;
            flex: 1;
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            color: white;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        /* Responsive adjustments */
        @media (max-width: 600px) {
            .resolution-group {
                flex-direction: column;
                gap: 5px;
            }
            
            .checkbox-group, .radio-group {
                flex-direction: column;
                gap: 5px;
            }
            
            .form-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="tabs">
            <div class="tab active" data-tab="server">Серверное оборудование</div>
            <div class="tab" data-tab="client">Клиентское оборудование</div>
        </div>
        
        <!-- Server Equipment Tab -->
        <div class="tab-content active" id="server-tab">
            <h2>Основные вопросы для расчета серверного оборудования</h2>
            
            <div class="question">
                <label class="question-label">1. Общее количество камер</label>
                <input type="number" min="1" value="1" id="total-cameras">
            </div>
            
            <div class="question">
                <label class="question-label">2. Кодек камер</label>
                <select id="codec">
                    <option value="h265">h265</option>
                    <option value="h264">h264</option>
                </select>
            </div>
            
            <div class="question">
                <label class="question-label">3. Разрешение основного и дополнительного потока</label>
                
                <div id="camera-sets">
                    <div class="camera-set">
                        <button class="remove-set">×</button>
                        <label>Кол-во камер:</label>
                        <input type="number" min="1" value="1" class="camera-count">
                        
                        <div class="resolution-group">
                            <div>
                                <label>Основной:</label>
                                <select class="main-stream">
                                    <option value="0.3">0,3 MP</option>
                                    <option value="0.4">0,4 MP</option>
                                    <option value="1">1 MP</option>
                                    <option value="1.3">1,3 MP</option>
                                    <option value="2">2 MP</option>
                                    <option value="3">3 MP</option>
                                    <option value="4">4 MP</option>
                                    <option value="5">5 MP</option>
                                    <option value="6">6 MP</option>
                                    <option value="8">8 MP</option>
                                    <option value="10">10 MP</option>
                                    <option value="12">12 MP</option>
                                </select>
                            </div>
                            <div>
                                <label>Дополнительный:</label>
                                <select class="sub-stream">
                                    <option value="0.3">0,3 MP</option>
                                    <option value="0.4">0,4 MP</option>
                                    <option value="1">1 MP</option>
                                    <option value="1.3">1,3 MP</option>
                                    <option value="2">2 MP</option>
                                    <option value="3">3 MP</option>
                                    <option value="4">4 MP</option>
                                    <option value="5">5 MP</option>
                                    <option value="6">6 MP</option>
                                    <option value="8">8 MP</option>
                                    <option value="10">10 MP</option>
                                    <option value="12">12 MP</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="analytics-section">
                            <label>Аналитика:</label>
                            <div class="analytics-items">
                                <div class="analytics-item">
                                    <select class="analytics-select">
                                        <option value="">Выберите аналитику</option>
                                        <option value="motion">Детектор движения</option>
                                        <option value="object_search">Поиск объектов</option>
                                        <option value="tracking">Трекинг</option>
                                        <option value="visitor_count">Подсчет посетителей</option>
                                        <option value="queue_length">Определение длины очереди</option>
                                        <option value="crowd_detection">Детектор скопления людей</option>
                                        <option value="heat_map">Тепловая карта интенсивности движения</option>
                                        <option value="staff_control">Контроль активности персонала</option>
                                        <option value="face_detection">Обнаружение лиц</option>
                                        <option value="sabotage_detection">Детектор саботажа</option>
                                        <option value="abandoned_objects">Обнаружение оставленных предметов</option>
                                        <option value="smoke_fire">Детектор дыма и огня</option>
                                        <option value="uniform_control">Контроль спецодежды</option>
                                        <option value="license_plate_macroscop">Распознование автономеров (Macroscop)</option>
                                        <option value="license_plate_complete">Распознование автономеров (Complete)</option>
                                        <option value="license_plate_light">Распознование автономеров (Light)</option>
                                        <option value="shelf_monitoring">Наполненность полок</option>
                                        <option value="face_recognition_light">Распознование лиц (Light)</option>
                                        <option value="face_recognition_complete">Распознование лиц (Complete)</option>
                                        <option value="unique_visitor_count">Подсчет уникальных посетителей</option>
                                        <option value="object_counting">Подсчет объектов</option>
                                        <option value="special_transport">Обнаружение спецтранспорта</option>
                                        <option value="fall_detection">Обнаружение падений</option>
                                    </select>
                                    <button class="btn-small remove">-</button>
                                </div>
                            </div>
                            <button class="btn-small add-analytics">+ Добавить</button>
                        </div>
                    </div>
                </div>
                
                <button class="add-set">+ Добавить набор камер</button>
            </div>
            
            <div class="question">
                <label class="question-label">4. Операционная система</label>
                <select id="os">
                    <option value="win10">Windows 10</option>
                    <option value="win11">Windows 11</option>
                    <option value="ubuntu20">Ubuntu 20.04</option>
                    <option value="ubuntu22">Ubuntu 22.04</option>
                    <option value="ubuntu24">Ubuntu 24.04</option>
                    <option value="astra">Astra Linux Special Edition 1.7</option>
                    <option value="alt_work10">Alt Linux Workstation 10</option>
                    <option value="alt_sp_work10">ALT SP Linux Workstation 10</option>
                    <option value="alt_server10">ALT Linux Server 10</option>
                    <option value="alt_sp_server10">ALT SP Linux Server 10</option>
                    <option value="red_os7">РЕД ОС 7</option>
                    <option value="red_os8">РЕД ОС 8</option>
                    <option value="rosa">Роса «Хром» 12</option>
                </select>
            </div>
            
            <div class="question">
                <label class="question-label">5. Запись и хранение архива</label>
                <div style="display: flex; gap: 10px; margin-top: 5px;">
                    <div>
                        <label>Хранение (дней):</label>
                        <input type="number" min="1" value="30" id="archive-days">
                    </div>
                    <div>
                        <label>Запись (ч/сут):</label>
                        <input type="number" min="1" max="24" value="24" id="recording-hours">
                    </div>
                </div>
            </div>
            
            <div class="question">
                <label class="question-label">6. Инфраструктура системы видеонаблюдения:</label>
                <div class="infrastructure-options">
                    <div class="infrastructure-option">
                        <input type="radio" name="infrastructure" value="central" id="central">
                        <label for="central">Единый центр обработки</label>
                    </div>
                    <div class="infrastructure-option">
                        <input type="radio" name="infrastructure" value="per-object" id="per-object">
                        <label for="per-object">Сервер на каждом объекте</label>
                    </div>
                    <div class="infrastructure-option">
                        <input type="radio" name="infrastructure" value="custom" id="custom">
                        <label for="custom">Свой вариант</label>
                    </div>
                </div>
                <div class="custom-answer" id="custom-answer">
                    <textarea placeholder="Опишите свою инфраструктуру..." id="custom-infrastructure"></textarea>
                </div>
            </div>
            
            <h2 style="position: relative;">
                Техническая часть реализации сервера
                <span class="tooltip">?
                    <span class="tooltiptext">Блок заполняется при необходимости подбора сервера</span>
                </span>
            </h2>
            
            <div class="question">
                <label class="question-label">Только подбор спецификаций?</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="specs-only-yes">
                        <label for="specs-only-yes">Да</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="specs-only-no">
                        <label for="specs-only-no">Нет</label>
                    </div>
                </div>
            </div>
            
            <div class="question">
                <label class="question-label">Подбор серверного оборудования?</label>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="server-equipment-yes">
                        <label for="server-equipment-yes">Да</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="server-equipment-no">
                        <label for="server-equipment-no">Нет</label>
                    </div>
                </div>
            </div>
            
            <div id="server-details" class="hidden">
                <h3>Вопросы для подбора серверного оборудования:</h3>
                
                <div class="question">
                    <label class="question-label">1. Исполнение корпуса:</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" name="server-form" value="rack" id="rack">
                            <label for="rack">rack</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" name="server-form" value="tower" id="tower">
                            <label for="tower">tower</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">2. Мониторы для отображения камер?</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="monitors-yes">
                            <label for="monitors-yes">Да</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="monitors-no">
                            <label for="monitors-no">Нет</label>
                        </div>
                    </div>
                </div>
                
                <div id="monitor-details" class="hidden">
                    <div class="question">
                        <label class="question-label">2.1 Разрешение мониторов:
                            <span class="tooltip">?
                                <span class="tooltiptext">Чем выше разрешение, тем больше мощностей требуется</span>
                            </span>
                        </label>
                        <select id="monitor-resolution">
                            <option value="hd">HD (1280x720)</option>
                            <option value="fhd">FHD (1920×1080)</option>
                            <option value="2k">2K (2048x1080)</option>
                            <option value="4k">4K (3840×2160)</option>
                            <option value="8k">8K (7680×4320)</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <label class="question-label">2.2 Количество мониторов:</label>
                        <input type="number" min="1" value="1" id="monitor-count">
                    </div>
                    
                    <div class="question">
                        <label class="question-label">2.3 Количество камер на мониторах:</label>
                        <input type="number" min="1" value="1" id="cameras-on-monitors">
                    </div>
                    
                    <div class="question">
                        <label class="question-label">2.4 Количество камер для архива (1-16):</label>
                        <input type="number" min="1" max="16" value="1" id="archive-cameras">
                    </div>
                </div>
                
                <div class="question">
                    <label class="question-label">3. Hot swap для архивной дисковой группы?</label>
                    <input type="checkbox" id="hot-swap" style="float: right; transform: scale(1.1);">
                </div>
                
                <div class="question">
                    <label class="question-label">4. Требуемые уровни Raid:</label>
                    <select id="raid-level">
                        <option value="raid0">RAID 0</option>
                        <option value="raid1">RAID 1</option>
                        <option value="raid5">RAID 5</option>
                        <option value="raid6">RAID 6</option>
                        <option value="raid10">RAID 10</option>
                    </select>
                </div>
                
                <div class="question">
                    <label class="question-label">5. Зеркалирование системного раздела (Raid 1)?</label>
                    <input type="checkbox" id="raid1-mirror" style="float: right; transform: scale(1.1);">
                </div>
                
                <div class="question">
                    <label class="question-label">6. Резервирование питания (два блока питания)?</label>
                    <input type="checkbox" id="dual-psu" style="float: right; transform: scale(1.1);">
                </div>
                
                <div class="question">
                    <label class="question-label">7. Использовать IPMI при сборке сервера?</label>
                    <input type="checkbox" id="ipmi" style="float: right; transform: scale(1.1);">
                </div>
            </div>
        </div>
        
        <!-- Client Equipment Tab -->
        <div class="tab-content" id="client-tab">
            <h2>Основные вопросы для расчета клиентского оборудования</h2>
            
            <div class="question">
                <label class="question-label">1. Количество мониторов:</label>
                <input type="number" min="1" value="1" id="client-monitor-count">
            </div>
            
            <div class="question">
                <label class="question-label">2. Разрешение мониторов:
                    <span class="tooltip">?
                        <span class="tooltiptext">Чем выше разрешение, тем больше мощностей требуется</span>
                    </span>
                </label>
                <select id="client-monitor-resolution">
                    <option value="hd">HD (1280x720)</option>
                    <option value="fhd">FHD (1920×1080)</option>
                    <option value="2k">2K (2048x1080)</option>
                    <option value="4k">4K (3840×2160)</option>
                    <option value="8k">8K (7680×4320)</option>
                </select>
            </div>
            
            <div class="question">
                <label class="question-label">3. Разрешение камер (основной и дополнительный поток)</label>
                
                <div class="resolution-group">
                    <div>
                        <label>Основной:</label>
                        <select id="client-main-stream">
                            <option value="0.3">0,3 MP</option>
                            <option value="0.4">0,4 MP</option>
                            <option value="1">1 MP</option>
                            <option value="1.3">1,3 MP</option>
                            <option value="2">2 MP</option>
                            <option value="3">3 MP</option>
                            <option value="4">4 MP</option>
                            <option value="5">5 MP</option>
                            <option value="6">6 MP</option>
                            <option value="8">8 MP</option>
                            <option value="10">10 MP</option>
                            <option value="12">12 MP</option>
                        </select>
                    </div>
                    <div>
                        <label>Дополнительный:</label>
                        <select id="client-sub-stream">
                            <option value="0.3">0,3 MP</option>
                            <option value="0.4">0,4 MP</option>
                            <option value="1">1 MP</option>
                            <option value="1.3">1,3 MP</option>
                            <option value="2">2 MP</option>
                            <option value="3">3 MP</option>
                            <option value="4">4 MP</option>
                            <option value="5">5 MP</option>
                            <option value="6">6 MP</option>
                            <option value="8">8 MP</option>
                            <option value="10">10 MP</option>
                            <option value="12">12 MP</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="question">
                <label class="question-label">4. Количество камер для просмотра архива (1-16):</label>
                <input type="number" min="1" max="16" value="1" id="client-archive-cameras">
            </div>
            
            <div class="question">
                <label class="question-label">5. Исполнение корпуса клиентского рабочего места:</label>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" name="client-form" value="rack" id="client-rack">
                        <label for="client-rack">rack</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" name="client-form" value="tower" id="client-tower">
                        <label for="client-tower">tower</label>
                    </div>
                </div>
            </div>
            
            <div class="question">
                <label class="question-label">6. Зеркалирование системного раздела (Raid 1)?</label>
                <input type="checkbox" id="client-raid1-mirror" style="float: right; transform: scale(1.1);">
            </div>
            
            <div class="question">
                <label class="question-label">7. Количество клиентских рабочих станций:</label>
                <input type="number" min="1" value="1" id="client-workstations">
            </div>
        </div>
        
        <div class="form-buttons">
            <button class="btn btn-secondary" id="copy-btn">Сохранить в буфер</button>
            <button class="btn btn-primary" id="save-btn">Сохранить в txt</button>
        </div>
    </div>

    <script>
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and content
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab
                tab.classList.add('active');
                
                // Show corresponding content
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // Infrastructure options
        document.querySelectorAll('input[name="infrastructure"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const customAnswer = document.getElementById('custom-answer');
                if (this.value === 'custom' && this.checked) {
                    customAnswer.classList.add('active');
                } else {
                    customAnswer.classList.remove('active');
                }
            });
        });
        
        // Server equipment details
        document.getElementById('server-equipment-yes').addEventListener('change', function() {
            document.getElementById('server-details').classList.toggle('hidden', !this.checked);
        });
        
        // Monitor details
        document.getElementById('monitors-yes').addEventListener('change', function() {
            document.getElementById('monitor-details').classList.toggle('hidden', !this.checked);
        });
        
        // Camera sets functionality
        document.addEventListener('click', function(e) {
            // Add analytics
            if (e.target.classList.contains('add-analytics')) {
                const analyticsSection = e.target.closest('.analytics-section');
                const analyticsItems = analyticsSection.querySelector('.analytics-items');
                const newItem = document.createElement('div');
                newItem.className = 'analytics-item';
                newItem.innerHTML = `
                    <select class="analytics-select">
                        <option value="">Выберите аналитику</option>
                        <option value="motion">Детектор движения</option>
                        <option value="object_search">Поиск объектов</option>
                        <option value="tracking">Трекинг</option>
                        <option value="visitor_count">Подсчет посетителей</option>
                        <option value="queue_length">Определение длины очереди</option>
                        <option value="crowd_detection">Детектор скопления людей</option>
                        <option value="heat_map">Тепловая карта интенсивности движения</option>
                        <option value="staff_control">Контроль активности персонала</option>
                        <option value="face_detection">Обнаружение лиц</option>
                        <option value="sabotage_detection">Детектор саботажа</option>
                        <option value="abandoned_objects">Обнаружение оставленных предметов</option>
                        <option value="smoke_fire">Детектор дыма и огня</option>
                        <option value="uniform_control">Контроль спецодежды</option>
                        <option value="license_plate_macroscop">Распознование автономеров (Macroscop)</option>
                        <option value="license_plate_complete">Распознование автономеров (Complete)</option>
                        <option value="license_plate_light">Распознование автономеров (Light)</option>
                        <option value="shelf_monitoring">Наполненность полок</option>
                        <option value="face_recognition_light">Распознование лиц (Light)</option>
                        <option value="face_recognition_complete">Распознование лиц (Complete)</option>
                        <option value="unique_visitor_count">Подсчет уникальных посетителей</option>
                        <option value="object_counting">Подсчет объектов</option>
                        <option value="special_transport">Обнаружение спецтранспорта</option>
                        <option value="fall_detection">Обнаружение падений</option>
                    </select>
                    <button class="btn-small remove">-</button>
                `;
                analyticsItems.appendChild(newItem);
            }
            
            // Remove analytics
            if (e.target.classList.contains('remove') && e.target.closest('.analytics-item')) {
                e.target.closest('.analytics-item').remove();
            }
            
            // Add camera set
            if (e.target.classList.contains('add-set')) {
                const cameraSets = document.getElementById('camera-sets');
                const newSet = document.createElement('div');
                newSet.className = 'camera-set';
                newSet.innerHTML = `
                    <button class="remove-set">×</button>
                    <label>Кол-во камер:</label>
                    <input type="number" min="1" value="1" class="camera-count">
                    
                    <div class="resolution-group">
                        <div>
                            <label>Основной:</label>
                            <select class="main-stream">
                                <option value="0.3">0,3 MP</option>
                                <option value="0.4">0,4 MP</option>
                                <option value="1">1 MP</option>
                                <option value="1.3">1,3 MP</option>
                                <option value="2">2 MP</option>
                                <option value="3">3 MP</option>
                                <option value="4">4 MP</option>
                                <option value="5">5 MP</option>
                                <option value="6">6 MP</option>
                                <option value="8">8 MP</option>
                                <option value="10">10 MP</option>
                                <option value="12">12 MP</option>
                            </select>
                        </div>
                        <div>
                            <label>Дополнительный:</label>
                            <select class="sub-stream">
                                <option value="0.3">0,3 MP</option>
                                <option value="0.4">0,4 MP</option>
                                <option value="1">1 MP</option>
                                <option value="1.3">1,3 MP</option>
                                <option value="2">2 MP</option>
                                <option value="3">3 MP</option>
                                <option value="4">4 MP</option>
                                <option value="5">5 MP</option>
                                <option value="6">6 MP</option>
                                <option value="8">8 MP</option>
                                <option value="10">10 MP</option>
                                <option value="12">12 MP</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="analytics-section">
                        <label>Аналитика:</label>
                        <div class="analytics-items">
                            <div class="analytics-item">
                                <select class="analytics-select">
                                    <option value="">Выберите аналитику</option>
                                    <option value="motion">Детектор движения</option>
                                    <option value="object_search">Поиск объектов</option>
                                    <option value="tracking">Трекинг</option>
                                    <option value="visitor_count">Подсчет посетителей</option>
                                    <option value="queue_length">Определение длины очереди</option>
                                    <option value="crowd_detection">Детектор скопления людей</option>
                                    <option value="heat_map">Тепловая карта интенсивности движения</option>
                                    <option value="staff_control">Контроль активности персонала</option>
                                    <option value="face_detection">Обнаружение лиц</option>
                                    <option value="sabotage_detection">Детектор саботажа</option>
                                    <option value="abandoned_objects">Обнаружение оставленных предметов</option>
                                    <option value="smoke_fire">Детектор дыма и огня</option>
                                    <option value="uniform_control">Контроль спецодежды</option>
                                    <option value="license_plate_macroscop">Распознование автономеров (Macroscop)</option>
                                    <option value="license_plate_complete">Распознование автономеров (Complete)</option>
                                    <option value="license_plate_light">Распознование автономеров (Light)</option>
                                    <option value="shelf_monitoring">Наполненность полок</option>
                                    <option value="face_recognition_light">Распознование лиц (Light)</option>
                                    <option value="face_recognition_complete">Распознование лиц (Complete)</option>
                                    <option value="unique_visitor_count">Подсчет уникальных посетителей</option>
                                    <option value="object_counting">Подсчет объектов</option>
                                    <option value="special_transport">Обнаружение спецтранспорта</option>
                                    <option value="fall_detection">Обнаружение падений</option>
                                </select>
                                <button class="btn-small remove">-</button>
                            </div>
                        </div>
                        <button class="btn-small add-analytics">+ Добавить</button>
                    </div>
                `;
                cameraSets.appendChild(newSet);
            }
            
            // Remove camera set
            if (e.target.classList.contains('remove-set')) {
                if (document.querySelectorAll('.camera-set').length > 1) {
                    e.target.closest('.camera-set').remove();
                } else {
                    alert('Нельзя удалить последний набор камер');
                }
            }
        });
        
        // Copy to clipboard functionality
        document.getElementById('copy-btn').addEventListener('click', function() {
            let results = "# Опросный лист Macroscop\n\n";
            
            // Server tab data
            results += "## Серверное оборудование\n\n";
            results += `1. Общее количество камер: ${document.getElementById('total-cameras').value}\n`;
            results += `2. Кодек: ${document.getElementById('codec').value}\n`;
            results += `4. ОС: ${document.getElementById('os').value}\n`;
            results += `5. Хранение архива: ${document.getElementById('archive-days').value} дней\n`;
            results += `   Запись: ${document.getElementById('recording-hours').value} ч/сут\n`;
            
            // Infrastructure
            const infrastructure = document.querySelector('input[name="infrastructure"]:checked');
            if (infrastructure) {
                results += `6. Инфраструктура: ${infrastructure.nextElementSibling.textContent}\n`;
                if (infrastructure.value === 'custom' && document.getElementById('custom-infrastructure').value) {
                    results += `   Пользовательский вариант: ${document.getElementById('custom-infrastructure').value}\n`;
                }
            }
            
            // Technical details
            results += "\n### Техническая часть\n\n";
            results += `- Только спецификации: ${document.getElementById('specs-only-yes').checked ? 'Да' : 'Нет'}\n`;
            results += `- Подбор оборудования: ${document.getElementById('server-equipment-yes').checked ? 'Да' : 'Нет'}\n`;
            
            if (document.getElementById('server-equipment-yes').checked) {
                const serverForm = document.querySelector('input[name="server-form"]:checked');
                if (serverForm) {
                    results += `- Исполнение корпуса: ${serverForm.value}\n`;
                }
                
                results += `- Мониторы: ${document.getElementById('monitors-yes').checked ? 'Да' : 'Нет'}\n`;
                
                if (document.getElementById('monitors-yes').checked) {
                    results += `- Разрешение мониторов: ${document.getElementById('monitor-resolution').value}\n`;
                    results += `- Количество мониторов: ${document.getElementById('monitor-count').value}\n`;
                    results += `- Камер на мониторах: ${document.getElementById('cameras-on-monitors').value}\n`;
                    results += `- Камер для архива: ${document.getElementById('archive-cameras').value}\n`;
                }
                
                results += `- Hot swap: ${document.getElementById('hot-swap').checked ? 'Да' : 'Нет'}\n`;
                results += `- RAID: ${document.getElementById('raid-level').value}\n`;
                results += `- RAID 1 системный: ${document.getElementById('raid1-mirror').checked ? 'Да' : 'Нет'}\n`;
                results += `- Двойной БП: ${document.getElementById('dual-psu').checked ? 'Да' : 'Нет'}\n`;
                results += `- IPMI: ${document.getElementById('ipmi').checked ? 'Да' : 'Нет'}\n`;
            }
            
            // Camera sets
            results += "\n### Наборы камер:\n";
            document.querySelectorAll('.camera-set').forEach((set, index) => {
                const count = set.querySelector('.camera-count').value;
                const mainStream = set.querySelector('.main-stream').value;
                const subStream = set.querySelector('.sub-stream').value;
                
                results += `\n${index+1}. Количество: ${count}\n`;
                results += `   Основной поток: ${mainStream} MP\n`;
                results += `   Дополнительный поток: ${subStream} MP\n`;
                
                const analytics = [];
                set.querySelectorAll('.analytics-select').forEach(select => {
                    if (select.value) {
                        const text = select.options[select.selectedIndex].text;
                        analytics.push(text);
                    }
                });
                
                if (analytics.length > 0) {
                    results += `   Аналитика: ${analytics.join(', ')}\n`;
                }
            });
            
            // Client tab data
            results += "\n\n## Клиентское оборудование\n\n";
            results += `1. Количество мониторов: ${document.getElementById('client-monitor-count').value}\n`;
            results += `2. Разрешение мониторов: ${document.getElementById('client-monitor-resolution').value}\n`;
            results += `3. Основной поток: ${document.getElementById('client-main-stream').value} MP\n`;
            results += `   Дополнительный поток: ${document.getElementById('client-sub-stream').value} MP\n`;
            results += `4. Камер для архива: ${document.getElementById('client-archive-cameras').value}\n`;
            
            const clientForm = document.querySelector('input[name="client-form"]:checked');
            if (clientForm) {
                results += `5. Исполнение корпуса: ${clientForm.value}\n`;
            }
            
            results += `6. RAID 1 системный: ${document.getElementById('client-raid1-mirror').checked ? 'Да' : 'Нет'}\n`;
            results += `7. Клиентских станций: ${document.getElementById('client-workstations').value}\n`;
            
            // Copy to clipboard
            navigator.clipboard.writeText(results)
                .then(() => {
                    const btn = document.getElementById('copy-btn');
                    const originalText = btn.textContent;
                    btn.textContent = 'Скопировано!';
                    setTimeout(() => {
                        btn.textContent = originalText;
                    }, 2000);
                })
                .catch(err => {
                    alert('Ошибка копирования: ' + err);
                });
        });
        
        // Save to file functionality
        document.getElementById('save-btn').addEventListener('click', function() {
            let results = "# Опросный лист Macroscop\n\n";
            
            // Server tab data
            results += "## Серверное оборудование\n\n";
            results += `1. Общее количество камер: ${document.getElementById('total-cameras').value}\n`;
            results += `2. Кодек: ${document.getElementById('codec').value}\n`;
            results += `4. ОС: ${document.getElementById('os').value}\n`;
            results += `5. Хранение архива: ${document.getElementById('archive-days').value} дней\n`;
            results += `   Запись: ${document.getElementById('recording-hours').value} ч/сут\n`;
            
            // Infrastructure
            const infrastructure = document.querySelector('input[name="infrastructure"]:checked');
            if (infrastructure) {
                results += `6. Инфраструктура: ${infrastructure.nextElementSibling.textContent}\n`;
                if (infrastructure.value === 'custom' && document.getElementById('custom-infrastructure').value) {
                    results += `   Пользовательский вариант: ${document.getElementById('custom-infrastructure').value}\n`;
                }
            }
            
            // Technical details
            results += "\n### Техническая часть\n\n";
            results += `- Только спецификации: ${document.getElementById('specs-only-yes').checked ? 'Да' : 'Нет'}\n`;
            results += `- Подбор оборудования: ${document.getElementById('server-equipment-yes').checked ? 'Да' : 'Нет'}\n`;
            
            if (document.getElementById('server-equipment-yes').checked) {
                const serverForm = document.querySelector('input[name="server-form"]:checked');
                if (serverForm) {
                    results += `- Исполнение корпуса: ${serverForm.value}\n`;
                }
                
                results += `- Мониторы: ${document.getElementById('monitors-yes').checked ? 'Да' : 'Нет'}\n`;
                
                if (document.getElementById('monitors-yes').checked) {
                    results += `- Разрешение мониторов: ${document.getElementById('monitor-resolution').value}\n`;
                    results += `- Количество мониторов: ${document.getElementById('monitor-count').value}\n`;
                    results += `- Камер на мониторах: ${document.getElementById('cameras-on-monitors').value}\n`;
                    results += `- Камер для архива: ${document.getElementById('archive-cameras').value}\n`;
                }
                
                results += `- Hot swap: ${document.getElementById('hot-swap').checked ? 'Да' : 'Нет'}\n`;
                results += `- RAID: ${document.getElementById('raid-level').value}\n`;
                results += `- RAID 1 системный: ${document.getElementById('raid1-mirror').checked ? 'Да' : 'Нет'}\n`;
                results += `- Двойной БП: ${document.getElementById('dual-psu').checked ? 'Да' : 'Нет'}\n`;
                results += `- IPMI: ${document.getElementById('ipmi').checked ? 'Да' : 'Нет'}\n`;
            }
            
            // Camera sets
            results += "\n### Наборы камер:\n";
            document.querySelectorAll('.camera-set').forEach((set, index) => {
                const count = set.querySelector('.camera-count').value;
                const mainStream = set.querySelector('.main-stream').value;
                const subStream = set.querySelector('.sub-stream').value;
                
                results += `\n${index+1}. Количество: ${count}\n`;
                results += `   Основной поток: ${mainStream} MP\n`;
                results += `   Дополнительный поток: ${subStream} MP\n`;
                
                const analytics = [];
                set.querySelectorAll('.analytics-select').forEach(select => {
                    if (select.value) {
                        const text = select.options[select.selectedIndex].text;
                        analytics.push(text);
                    }
                });
                
                if (analytics.length > 0) {
                    results += `   Аналитика: ${analytics.join(', ')}\n`;
                }
            });
            
            // Client tab data
            results += "\n\n## Клиентское оборудование\n\n";
            results += `1. Количество мониторов: ${document.getElementById('client-monitor-count').value}\n`;
            results += `2. Разрешение мониторов: ${document.getElementById('client-monitor-resolution').value}\n`;
            results += `3. Основной поток: ${document.getElementById('client-main-stream').value} MP\n`;
            results += `   Дополнительный поток: ${document.getElementById('client-sub-stream').value} MP\n`;
            results += `4. Камер для архива: ${document.getElementById('client-archive-cameras').value}\n`;
            
            const clientForm = document.querySelector('input[name="client-form"]:checked');
            if (clientForm) {
                results += `5. Исполнение корпуса: ${clientForm.value}\n`;
            }
            
            results += `6. RAID 1 системный: ${document.getElementById('client-raid1-mirror').checked ? 'Да' : 'Нет'}\n`;
            results += `7. Клиентских станций: ${document.getElementById('client-workstations').value}\n`;
            
            // Create and download file
            const blob = new Blob([results], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Опросный лист Macroscop.txt';
            document.body.appendChild(a);
            a.click();
            
            // Clean up
            setTimeout(() => {
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }, 0);
        });
    </script>
</body>
</html>
